<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í…ŒìŠ¤íŠ¸ ê³„ì • ìƒì„± - HVAC ê´€ë¦¬</title>
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        h1 {
            color: #667eea;
            margin-bottom: 20px;
        }
        .status {
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            font-size: 14px;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
        }
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
        }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 20px;
        }
        button:hover {
            background: #5568d3;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        pre {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ í…ŒìŠ¤íŠ¸ ê³„ì • ìƒì„± ë„êµ¬</h1>
        <p>Firebase Authenticationê³¼ Firestoreì— í…ŒìŠ¤íŠ¸ ê³„ì •ì„ ìƒì„±í•©ë‹ˆë‹¤.</p>
        
        <div id="output"></div>
        
        <button onclick="createTestAccounts()" id="createBtn">í…ŒìŠ¤íŠ¸ ê³„ì • ìƒì„±</button>
        
        <h2>ìƒì„±ë  ê³„ì • ëª©ë¡:</h2>
        <pre>
1. ì ê²€ì ê³„ì •
   - ì´ë©”ì¼: inspector@hvac.com
   - ë¹„ë°€ë²ˆí˜¸: hvac1234
   - ì—­í• : inspector

2. ê´€ë¦¬ì ê³„ì •
   - ì´ë©”ì¼: manager@hvac.com
   - ë¹„ë°€ë²ˆí˜¸: hvac1234
   - ì—­í• : manager

3. ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì •
   - ì´ë©”ì¼: admin@hvac.com
   - ë¹„ë°€ë²ˆí˜¸: hvac1234
   - ì—­í• : admin
        </pre>
        
        <h2>ì£¼ì˜ì‚¬í•­:</h2>
        <ul>
            <li>ì´ ë„êµ¬ëŠ” ê°œë°œ/í…ŒìŠ¤íŠ¸ ìš©ë„ë¡œë§Œ ì‚¬ìš©í•˜ì„¸ìš”</li>
            <li>Firebase Consoleì—ì„œ Authenticationì„ í™œì„±í™”í•´ì•¼ í•©ë‹ˆë‹¤</li>
            <li>ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸ ì¸ì¦ì„ ì‚¬ìš©í•©ë‹ˆë‹¤</li>
        </ul>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';
        import { getFirestore } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';
        import { getAuth, createUserWithEmailAndPassword } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';
        
        const firebaseConfig = {
            apiKey: "AIzaSyD7YfLEw3N7aV9lqT6cboMo-WTN4hKGn8Q",
            authDomain: "hvac-management-5634d.firebaseapp.com",
            projectId: "hvac-management-5634d",
            storageBucket: "hvac-management-5634d.firebasestorage.app",
            messagingSenderId: "638025486691",
            appId: "1:638025486691:web:64b7f7f7b0e7577f7ff5c6",
            measurementId: "G-1M9GPPB9E8"
        };

        const app = initializeApp(firebaseConfig);
        window.db = getFirestore(app);
        window.auth = getAuth(app);
    </script>
    
    <script src="js/firebase-config.js"></script>
    
    <script>
        const testAccounts = [
            { email: 'inspector@hvac.com', password: 'hvac1234', name: 'ê¹€ë¯¼ì¤€', role: 'inspector' },
            { email: 'manager@hvac.com', password: 'hvac1234', name: 'ì´ì„œì—°', role: 'manager' },
            { email: 'admin@hvac.com', password: 'hvac1234', name: 'ë°•ì§€ìš°', role: 'admin' }
        ];

        function addLog(message, type = 'info') {
            const output = document.getElementById('output');
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.textContent = message;
            output.appendChild(div);
            
            // ìë™ ìŠ¤í¬ë¡¤
            output.scrollTop = output.scrollHeight;
        }

        async function createTestAccounts() {
            const btn = document.getElementById('createBtn');
            btn.disabled = true;
            
            document.getElementById('output').innerHTML = '';
            addLog('ğŸš€ í…ŒìŠ¤íŠ¸ ê³„ì • ìƒì„± ì‹œì‘...', 'info');
            
            for (const account of testAccounts) {
                try {
                    // Firebase Authenticationì— ì‚¬ìš©ì ìƒì„±
                    addLog(`ğŸ“ ìƒì„± ì¤‘: ${account.email}`, 'info');
                    const userCredential = await createUserWithEmailAndPassword(
                        window.auth,
                        account.email,
                        account.password
                    );
                    
                    const uid = userCredential.user.uid;
                    addLog(`âœ… Auth ìƒì„± ì„±ê³µ: ${account.email} (UID: ${uid})`, 'success');
                    
                    // Firestoreì— ì‚¬ìš©ì ì •ë³´ ì €ì¥
                    const userDoc = {
                        email: account.email,
                        name: account.name,
                        role: account.role,
                        created_at: new Date().toISOString(),
                        created_by: 'setup-script'
                    };
                    
                    await window.FirestoreHelper.setDocument('users', uid, userDoc);
                    addLog(`âœ… Firestore ì €ì¥ ì„±ê³µ: ${account.name} (${account.role})`, 'success');
                    
                } catch (error) {
                    if (error.code === 'auth/email-already-in-use') {
                        addLog(`âš ï¸ ì´ë¯¸ ì¡´ì¬: ${account.email}`, 'info');
                    } else {
                        addLog(`âŒ ì˜¤ë¥˜: ${account.email} - ${error.message}`, 'error');
                    }
                }
            }
            
            addLog('', 'info');
            addLog('âœ… ëª¨ë“  ì‘ì—… ì™„ë£Œ!', 'success');
            addLog('ğŸ“Œ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ì—¬ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”.', 'info');
            
            btn.disabled = false;
        }
        
        // Firebase ì´ˆê¸°í™” ëŒ€ê¸°
        function waitForFirebase() {
            return new Promise((resolve) => {
                const checkInterval = setInterval(() => {
                    if (window.db && window.auth && window.FirestoreHelper) {
                        clearInterval(checkInterval);
                        resolve();
                    }
                }, 100);
            });
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ
        window.addEventListener('load', async () => {
            await waitForFirebase();
            addLog('âœ… Firebase ì´ˆê¸°í™” ì™„ë£Œ', 'success');
            addLog('ğŸ‘‰ "í…ŒìŠ¤íŠ¸ ê³„ì • ìƒì„±" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”', 'info');
        });
    </script>
</body>
</html>
